<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="miniproject.list_mapper">
<!-- 사전방문예약 db저장 -->
<insert id="visit_insert" parameterType="previsitdto">
insert into pre_visit(vidx,vapart,vdate,vtime,vname,vcount,vtel,add_date) 
values ('0',#{vapart},#{vdate},#{vtime},#{vname},#{vcount},#{vtel},now())
</insert>

<!-- 방문예약완료 확인 창 - 유저 예약정보 -->
<select id="visit_select" resultType="previsitdto" parameterType="Map">
select * from pre_visit where vapart=#{vapart} and vname=#{vname} and vtel=#{vtel}
</select>


<!-- 추천분양 정보 게시판 입력 -->
<insert id="list_new">
insert into good_list(lidx,lsubject,lname,lview,lcontext,ldate) 
values ('0',#{lsubject},#{lname},#{lview},#{lcontext},now())
</insert>


<!-- 추천분양 정보 게시판 출력 -->
<select id="list_select" resultType="listdto" parameterType="Map">
select * from good_list order by lidx desc limit #{spage},#{epage}
</select>

<!-- 게시판 검색기능 -->
<select id="list_search" resultType="listdto" parameterType="String">
select * from good_list where lsubject like concat('%',#{search},'%') order by lidx desc
</select>

<!-- 게시물 전체 데이터 개수 쿼리문 -->
<select id="list_total" resultType="int">
select count(*) as total from good_list
</select>

<!-- 게시물 상세 보기 -->
<select id="view_list" resultType="listdto" parameterType="int">
select * from good_list where lidx = #{lidx}
</select>

<!-- 조회수 증가 쿼리문 -->
<update id="update_view" parameterType="int">
update good_list set lview = lview + 1 where lidx = #{lidx}
</update>
</mapper>